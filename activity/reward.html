<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>公益上海</title>
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
    <meta content="yes" name="apple-mobile-web-app-capable">
    <meta content="black" name="apple-mobile-web-app-status-bar-style">
    <meta content="telephone=no" name="format-detection">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
    <meta http-equiv="Pragma" content="no-cache" />
    <meta http-equiv="Expires" content="0" />
    <link rel="stylesheet" type="text/css" href="../wap/css/index.css"/>
    <style>
        .warp_hd_u_by input{display: block;width: 45%;height: 36px;line-height: 36px;text-align: center;font-size: 16px;border-radius: 3px;border: 0;}
        .warp_hd_u_bu input{width: 80%;margin: 6% auto;height: 40px;padding-left: 3%;font-family: '微软雅黑';font-size: 14px;border: 1px solid #E6E6E6;}
        .warp_hd_u_ton{float: left;color: #FFFFFF;background: #72B81E}
        .warp_hd_u_bu span i{font-style: normal;}
    </style>
    <script type="text/javascript" src="../wap/js/jquery.js"></script>
</head>
<body>
<div class="warp">
    <!--头部开始-->
    <div class="warp_zy_j">
        <a href="javascript:history.go(-1);"></a>
        <span>积分打赏</span>
    </div>
    <!--头部结束-->
    <div class="warp_hd_i_ss">
        <img src="../wap/img/default_acti.png">
        <b id="act_name">上海公益活动</b>
        <span id="act_addr">上海市公益服务促进中心</span>
     </div>
    <div class="warp_hd_i_sa">
        <ul class="warp_hd_i_sm">
            <li>
                <input type="hidden" value="10">
                <span><i>10</i>积分</span>
            </li>
            <li>
                <input type="hidden" value="15">
                <span><i>15</i>积分</span>
            </li>
            <li>
                <input type="hidden" value="20">
                <span><i>20</i>积分</span>
            </li>
            <li>
                <input type="hidden" value="25">
                <span><i>25</i>积分</span>
            </li>
            <li>
                <input type="hidden" value="30">
                <span><i>30</i>积分</span>
            </li>
            <li>
                <input type="hidden" value="50">
                <span><i>50</i>积分</span>
            </li>
        </ul>
        <div class="warp_hd_i_sn">
            <a href="javascript:;">其他积分</a>
        </div>
    </div>
</div>
<!--是否赞赏开始-->
<div class="warp_hd_u" id="zs_sf">
    <div class="warp_hd_u_bp"></div>
    <div class="warp_hd_u_bo">
        <div class="warp_hd_u_bi">
            <a href="javascript:void(0)" style="width: 20px;height: 20px"></a>
        </div>
        <div class="warp_hd_u_bu">
            <b><i>10</i>积分</b>
            <span>是否赞赏<i>10</i>积分</span>
        </div>
        <div class="warp_hd_u_by">
            <a href="javascript:;" class="warp_hd_u_bt">确定</a>
            <a href="javascript:;" class="warp_hd_u_br">取消</a>
        </div>
    </div>
</div>
<!--是否赞赏结束-->

<!--赞赏成功开始-->
<div class="warp_hd_u" id="zs_cg">
    <div class="warp_hd_u_bp"></div>
    <div class="warp_hd_u_bo">
        <div class="warp_hd_u_bi">
            <a href="javascript:void(0)" style="width: 20px;height: 20px"></a>
        </div>
        <div class="warp_hd_u_be">
            <img src="../wap/img/pws_150.png">
            <b>赞赏成功</b>
            <span>感谢您对公益活动的支持！</span>
        </div>
    </div>
</div>
<!--赞赏成功结束-->
<!--其他积分开始-->
<div class="warp_hd_u" id="zs_cl">
    <div class="warp_hd_u_bp"></div>
    <div class="warp_hd_u_bo">
        <div class="warp_hd_u_bi">
            <a href="javascript:void(0)" style="width: 20px;height: 20px"></a>
        </div>
        <div class="warp_hd_u_bu">
            <input type="text" placeholder="请输入您要赞赏的积分" id="other_point">
        </div>
        <div class="warp_hd_u_by">
            <input type="button" value="确定" class="warp_hd_u_ton">
            <a href="javascript:;" class="warp_hd_u_br">取消</a>
        </div>
    </div>
</div>
<!--其他积分结束-->
</body>
<script type="text/javascript" src="../wap/js/config.js"></script>
<script type="text/javascript" src="../wap/js/public.js"></script>
<script type="text/javascript" src="../wap/Layer.m/layer.js"></script>

<script type="text/javascript" src="../wap/js/jquery.cookie.js"></script>
<script type="text/javascript" src="../wap/js/user/user.js"></script>

<script type="text/javascript">
    get_content()
    function get_content(){
        var activityCode = $_GET['activityCode'];
        var msg = '';
        var taghtml = '';
        $.ajax({
			xhrFields: {
               withCredentials: true
            },
            type:"POST",
            url:base_url + "html5/v1/activity/queryDetail",
            data:JSON.stringify({'activityCode':activityCode}),
            contentType: "application/json;charset=utf-8",
            dataType:'json',
            beforeSend:function(XMLHttpRequest){
                layer.open({type: 2,content: '加载中'});
            },
            success:function(data){
                    console.log(data)
                if(data.code==0){
                    var data1 = data.data;
                    $(document).attr("title",data1.name+'-公益上海');
                    if(data1.coverImg!=''){
                        $('.warp_hd_i_ss img').attr("src",data1.coverImg);
                    }  
                    $('#act_name').html(data1.name);
                    $('#act_addr').html(data1.address);
                     layer.closeAll();
                }else{
                    layer.open({
                    content: data.msg
                    ,skin: 'msg'
                    ,time: 1 //2秒后自动关闭
                    });
                   setTimeout(function(){layer.closeAll();},1000);
                }
            },
            error:function(e){
                layer.open({
                content: '加载失败'
                ,skin: 'msg'
                ,time: 1 //2秒后自动关闭
                });
                setTimeout(function(){layer.closeAll();},1000);
            }
        })
    }
</script>
<script type="text/javascript">
    function get_reward(point)
    {
        // 打赏操作
        var activityCode = $_GET['activityCode'];
        var orgCode = $_GET['orgCode'];
        var datainfo = JSON.stringify({
                "activityCode":activityCode,
                "orgCode":orgCode,
                "point":point,
                "user":user_msg.userId
            });
        $.ajax({
			xhrFields: {
               withCredentials: true
            },
            type:"POST",
            url:base_url + "html5/v1/activity/reward",
            data:datainfo,
            headers: {
                    'token': token
                },
            contentType: "application/json;charset=utf-8",
            dataType:'json',
            success:function(data){  
                // console.log(data)
                if(data.code==0){
                    $("#zs_sf").fadeOut();
                    $("#zs_cg").fadeIn();
                    $("#zs_cl").fadeOut();
                }else{
                    layer.open({
                        content: data.msg
                        ,skin: 'msg'
                        ,time: 1 //2秒后自动关闭
                    });
                }
            },
            error:function(e){
                layer.open({
                    content: '加载失败'
                    ,skin: 'msg'
                    ,time: 1 //2秒后自动关闭
                });
            }
        })
    }
</script>
<script language="javascript" type="text/javascript">
    $(function(){
        var cotrs = $(".warp_hd_i_sm li");
        cotrs.click(function(){
            $(this).addClass("thisclass").siblings().removeClass("thisclass");
            var points = $(this).children('input').val();
            $(".warp_hd_u_bu i").html(points)
        });
    });
    $(function(){
        $(".warp_hd_i_sm li").live("click",function(){
            $("#zs_sf").fadeIn();
        });
        $(".warp_hd_u_bt").live("click",function(){
            var point = $(".thisclass i").html()
            get_reward(point)
            
        });
        $(".warp_hd_u_bi").live("click",function(){
            $("#zs_sf").fadeOut();
            $("#zs_cg").fadeOut();
            $("#zs_cl").fadeOut();
        });
        $(".warp_hd_u_br").live("click",function(){
            $("#zs_sf").fadeOut();
            $("#zs_cl").fadeOut();
        });
        $(".warp_hd_i_sn a").live("click",function(){
            $("#zs_cl").fadeIn();
        });
        $(".warp_hd_u_ton").live("click",function(){
            var point = $("#other_point").val();
            if(point>0){
                get_reward(point);
            }else{
                layer.open({
                    content: '积分需要大于0'
                    ,skin: 'msg'
                    ,time: 1 //2秒后自动关闭
                });
            }
        });
    })

</script>
</html>